{"title":"MAC上配置Hexo部署GitHub Page","date":"2020-05-10T07:00:00.000Z","date_formatted":{"ll":"May 10, 2020","L":"05/10/2020","MM-DD":"05-10"},"thumbnail":"https://post-pic.nos-eastchina1.126.net/header_imgs/sweetgun-k_pBB5wJtaU-unsplash.jpg","link":"post/MAC-hexo","tags":["Blog-Construction","Hexo"],"categories":["环境配置"],"updated":"2020-05-11T20:31:19.919Z","content":"<p>前天熬过最后一场final，终于闲下来给这地方扫扫灰。这两天在MAC上配置了一些Hexo，虽然还有404页面和一些渲染的小问题，但是折腾了两天总算是能把最新的deploy到GitHub Page上了。在这写一下踩过的一些坑，顺便庆祝暑假开始，希望这个假期能多学点多写点。</p>\n<a id=\"more\"></a><h2 id=\"配置-hexo\">配置 Hexo<a href=\"#配置-hexo\" title=\"配置 Hexo\"></a></h2><p>这个就跟之前写的Windows上面配置差不多，完全可以参考<a href=\"https://hexo.io/docs/\" target=\"_blank\">Hexo的官方文档</a>。或者看一下这篇也可以<a href=\"https://zhuanlan.zhihu.com/p/75438236\" target=\"_blank\">mac下搭建hexo+github</a>。Git肯定都已经有了，剩下的就是安装Node.js。</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">brew install node</span><br></pre></td></tr></table></figure><p>Node.js利用Homebrew进行安装就方便管理，虽然中间踩了一些坑（后面会提到），但是也因此让操作变得简单了一些。然后就是安装Hexo了，一句话结束。</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">npm install -g hexo-cli</span><br></pre></td></tr></table></figure><p>到这里基本的框架都已经安装完成了，剩下的就是初始化博客。在合适的位置新建一个folder用来初始化。注意这里的folder要是空的，否则就彻底删除重头再来。</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">hexo init</span><br></pre></td></tr></table></figure><p>然后安装npm</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">npm install</span><br></pre></td></tr></table></figure><p>这之后folder里面Hexo博客必须的文件了，包括node中的一些必要的module。因为是从之前机器上迁移过来，只要把 <code>source/_post</code> 路径下单的Markdown文件替换，并加入想要的theme就行了。</p>\n<h2 id=\"踩坑\">踩坑<a href=\"#踩坑\" title=\"踩坑\"></a></h2><p>遇到的第一个坑是在Homebrew上面，安装Node的时候一直提示错误，没有某个路径的修改权限。输入<code>brew doctor</code> 会出现比如下面的问题。</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"string\">\"Warning: /usr/local/lib/pkgconfig isn't writable.\"</span></span><br></pre></td></tr></table></figure><p>其实可以按照终端里面给出的建议就可以了，只是<a href=\"https://stackoverflow.com/questions/27784545/brew-error-could-not-symlink-path-is-not-writable\" target=\"_blank\">StackOverflow</a>的这篇帖子解释的更清楚些，并讲了一下相关的过程。核心其实就是获取该路径的修改权限。</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">sudo chown -R $(whoami) /usr/<span class=\"built_in\">local</span>/lib/pkgconfig</span><br></pre></td></tr></table></figure><p>之后搭建博客的过程中，就遇到了和这篇<a href=\"https://zhuanlan.zhihu.com/p/136552969\" target=\"_blank\">知乎文章</a>几乎一模一样的问题。不论是运行 <code>hexo g</code> 或是 <code>hexo s</code>，终端都会显示如下烦人的warning。最后 <code>hexo d</code> 临门一脚就大功告称的时候，直接因为这几个warning无法部署。</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">(node:9876) Warning: Accessing non-existent property <span class=\"string\">'lineno'</span> of module exports inside circular dependency</span><br><span class=\"line\">(Use `node --trace-warnings ...` to show <span class=\"built_in\">where</span> the warning was created)</span><br><span class=\"line\">(node:9876) Warning: Accessing non-existent property <span class=\"string\">'column'</span> of module exports inside circular dependency</span><br><span class=\"line\">(node:9876) Warning: Accessing non-existent property <span class=\"string\">'filename'</span> of module exports inside circular dependency</span><br><span class=\"line\">(node:9876) Warning: Accessing non-existent property <span class=\"string\">'lineno'</span> of module exports inside circular dependency</span><br><span class=\"line\">(node:9876) Warning: Accessing non-existent property <span class=\"string\">'column'</span> of module exports inside circular dependency</span><br><span class=\"line\">(node:9876) Warning: Accessing non-existent property <span class=\"string\">'filename'</span> of module exports inside circular dependency</span><br></pre></td></tr></table></figure><p>这个情况就和Node.js的版本有关系了，之前用Homebrew安装的是默认最新版的Node.js 14，和Hexo之间似乎存在兼容性问题。而想要解决上面的问题就需要把安装的Node.js回滚到更稳定、更加兼容的老版本（12即可）。具体的操作是参照<a href=\"https://apple.stackexchange.com/questions/171530/how-do-i-downgrade-node-or-install-a-specific-previous-version-using-homebrew\" target=\"_blank\">StackExchange</a>的一篇帖子来的，分为以下几个步骤：</p>\n<p>检查利用brew安装的node版本</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">brew search node</span><br></pre></td></tr></table></figure><p>安装想要的node版本</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">brew install node@12</span><br></pre></td></tr></table></figure><p>我们可以在本地安装多个版本的node，但是我们不能同时使用它们。所以我们需要将最新版的node与brew解除连接。</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">brew unlink node</span><br></pre></td></tr></table></figure><p>禁用最新版之后，我们需要将brew和后来安装的老版本进行连接</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">brew link node@12</span><br></pre></td></tr></table></figure><p>输入这个之后发现link失败，提示该版本的node为key-only。这样我们就用下面的命令进行强制连接，从而使得老版本的node成为Hexo的依赖。</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">brew link --force --overwrite node@12</span><br></pre></td></tr></table></figure>","prev":{"title":"Java多线程基础","link":"post/Java多线程基础"},"next":{"title":"Java面向对象","link":"post/接口和抽象类"},"plink":"https://magi003769.github.io/post/MAC-hexo/","toc":[{"id":"配置-hexo","title":"配置 Hexo","index":"1"},{"id":"踩坑","title":"踩坑","index":"2"}]}