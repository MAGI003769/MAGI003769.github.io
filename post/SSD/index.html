<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 5.2.0">


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-doge.jpg">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-doge.jpg">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">



<link rel="stylesheet" href="//cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.15.1/css/all.min.css">
  <link rel="stylesheet" href="//cdn.jsdelivr.net/npm/nprogress@0.2.0/nprogress.css">
  <script src="//cdn.jsdelivr.net/npm/nprogress@0.2.0/nprogress.js"></script>

<script class="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"magi003769.github.io","root":"/","scheme":"Gemini","version":"8.0.1","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12},"copycode":false,"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"motion":{"enable":false,"async":false,"transition":{"sidebar":"fadeIn"}},"prism":false,"i18n":{"placeholder":"Searching...","empty":"We didn't find any results for the search: ${query}","hits_time":"${hits} results found in ${time} ms","hits":"${hits} results found"}};
  </script>

  <meta name="description" content="物体检测是计算机视觉中的一个基本任务。传统方法用不同尺寸的滑窗寻找可能的物体位置，再通过在相应区域应用边缘检测或者 HOG 等特征来检测图像中物体是否存在。在深度学习出现之后，CNN 就迅速被作为特征提取的工具应用到这个领域。于是便出现了何恺明大佬著名的 R-CNN 系列。作为深度学习在物体检测中应用的开山之作，R-CNN使用 Region Proposal Network (RPN) 来确定物体">
<meta property="og:type" content="article">
<meta property="og:title" content="Single Shot MultiBox Detector (SSD)">
<meta property="og:url" content="https://magi003769.github.io/post/SSD/index.html">
<meta property="og:site_name" content="QueinDecim">
<meta property="og:description" content="物体检测是计算机视觉中的一个基本任务。传统方法用不同尺寸的滑窗寻找可能的物体位置，再通过在相应区域应用边缘检测或者 HOG 等特征来检测图像中物体是否存在。在深度学习出现之后，CNN 就迅速被作为特征提取的工具应用到这个领域。于是便出现了何恺明大佬著名的 R-CNN 系列。作为深度学习在物体检测中应用的开山之作，R-CNN使用 Region Proposal Network (RPN) 来确定物体">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="http://post-pic.nos-eastchina1.126.net/object-detection/SSD_architecture.PNG">
<meta property="og:image" content="http://post-pic.nos-eastchina1.126.net/object-detection/default-box.PNG">
<meta property="article:published_time" content="2018-02-11T16:00:00.000Z">
<meta property="article:modified_time" content="2019-05-04T04:20:06.000Z">
<meta property="article:author" content="Jeff Wong">
<meta property="article:tag" content="Object-Detection">
<meta property="article:tag" content="SSD">
<meta property="article:tag" content="Computer-Vision">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http://post-pic.nos-eastchina1.126.net/object-detection/SSD_architecture.PNG">


<link rel="canonical" href="https://magi003769.github.io/post/SSD/">


<script class="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : false,
    isPost : true,
    lang   : 'en'
  };
</script>

  <title>Single Shot MultiBox Detector (SSD) | QueinDecim</title>
  






  <noscript>
  <style>
  body { margin-top: 2rem; }

  .use-motion .menu-item,
  .use-motion .sidebar,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header {
    visibility: visible;
  }

  .use-motion .header,
  .use-motion .site-brand-container .toggle,
  .use-motion .footer { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle,
  .use-motion .custom-logo-image {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line {
    transform: scaleX(1);
  }

  .search-pop-overlay, .sidebar-nav { display: none; }
  .sidebar-panel { display: block; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="headband"></div>

  <main class="main">
    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="Toggle navigation bar">
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <i class="logo-line"></i>
      <h1 class="site-title">QueinDecim</h1>
      <i class="logo-line"></i>
    </a>
      <p class="site-subtitle" itemprop="description">God in his heaven all's right with the world</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
    </div>
  </div>
</div>



<nav class="site-nav">
  <ul class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-home fa-fw"></i>Home</a>

  </li>
        <li class="menu-item menu-item-about">

    <a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>About</a>

  </li>
  </ul>
</nav>




</div>
        
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
  </div>

  <aside class="sidebar">

    <div class="sidebar-inner sidebar-nav-active sidebar-toc-active">
      <ul class="sidebar-nav">
        <li class="sidebar-nav-toc">
          Table of Contents
        </li>
        <li class="sidebar-nav-overview">
          Overview
        </li>
      </ul>

      <div class="sidebar-panel-container">
        <!--noindex-->
        <section class="post-toc-wrap sidebar-panel">
            <div class="post-toc animated"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#SSD-Model"><span class="nav-number">1.</span> <span class="nav-text">SSD Model</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Training"><span class="nav-number">2.</span> <span class="nav-text">Training</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Quantize-the-SSD-architecture"><span class="nav-number">3.</span> <span class="nav-text">Quantize the SSD architecture</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Reference"><span class="nav-number">4.</span> <span class="nav-text">Reference</span></a></li></ol></div>
        </section>
        <!--/noindex-->

        <section class="site-overview-wrap sidebar-panel">
          <div class="site-author site-overview-item animated" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="Jeff Wong"
      src="/images/spike_smoke.jpg">
  <p class="site-author-name" itemprop="name">Jeff Wong</p>
  <div class="site-description" itemprop="description">本当の声は いつだって 正しい道を照らしてる</div>
</div>
<div class="site-state-wrap site-overview-item animated">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives">
          <span class="site-state-item-count">53</span>
          <span class="site-state-item-name">posts</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/categories/">
        <span class="site-state-item-count">13</span>
        <span class="site-state-item-name">categories</span></a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/tags/">
        <span class="site-state-item-count">74</span>
        <span class="site-state-item-name">tags</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author site-overview-item animated">
      <span class="links-of-author-item">
        <a href="https://github.com/MAGI003769" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;MAGI003769" rel="noopener" target="_blank"><i class="fab fa-github fa-fw"></i></a>
      </span>
      <span class="links-of-author-item">
        <a href="https://www.facebook.com/ruihao.wang.777" title="FB Page → https:&#x2F;&#x2F;www.facebook.com&#x2F;ruihao.wang.777" rel="noopener" target="_blank"><i class="fab fa-facebook fa-fw"></i></a>
      </span>
      <span class="links-of-author-item">
        <a href="https://www.instagram.com/jeffwooong/" title="Instagram → https:&#x2F;www.instagram.com&#x2F;jeffwooong&#x2F;" rel="noopener" target="_blank"><i class="fab fa-instagram fa-fw"></i></a>
      </span>
      <span class="links-of-author-item">
        <a href="https://weibo.com/p/1005052622574043/home?from=page_100505&mod=TAB#place" title="Weibo → https:&#x2F;&#x2F;weibo.com&#x2F;p&#x2F;1005052622574043&#x2F;home?from&#x3D;page_100505&amp;mod&#x3D;TAB#place" rel="noopener" target="_blank"><i class="fab fa-weibo fa-fw"></i></a>
      </span>
  </div>



        </section>
      </div>
    </div>
  </aside>
  <div class="sidebar-dimmer"></div>


    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>

<noscript>
  <div class="noscript-warning">Theme NexT works best with JavaScript enabled</div>
</noscript>


    <div class="main-inner post posts-expand">
      

      

  


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="en">
    <link itemprop="mainEntityOfPage" href="https://magi003769.github.io/post/SSD/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/spike_smoke.jpg">
      <meta itemprop="name" content="Jeff Wong">
      <meta itemprop="description" content="本当の声は いつだって 正しい道を照らしてる">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="QueinDecim">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          Single Shot MultiBox Detector (SSD)
        </h1>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>

      <time title="Created: 2018-02-12 00:00:00" itemprop="dateCreated datePublished" datetime="2018-02-12T00:00:00+08:00">2018-02-12</time>
    </span>
      <span class="post-meta-item">
        <span class="post-meta-item-icon">
          <i class="far fa-calendar-check"></i>
        </span>
        <span class="post-meta-item-text">Edited on</span>
        <time title="Modified: 2019-05-04 12:20:06" itemprop="dateModified" datetime="2019-05-04T12:20:06+08:00">2019-05-04</time>
      </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">In</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/%E7%9B%AE%E6%A0%87%E6%A3%80%E6%B5%8B/" itemprop="url" rel="index"><span itemprop="name">目标检测</span></a>
        </span>
    </span>

  

</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
        <p>物体检测是计算机视觉中的一个基本任务。传统方法用不同尺寸的滑窗寻找可能的物体位置，再通过在相应区域应用边缘检测或者 HOG 等特征来检测图像中物体是否存在。在深度学习出现之后，CNN 就迅速被作为特征提取的工具应用到这个领域。于是便出现了何恺明大佬著名的 R-CNN 系列。作为深度学习在物体检测中应用的开山之作，R-CNN使用 Region Proposal Network (RPN) 来确定物体的位置，并用另外一个CNN作为特征提取和分类的网络。这样，R-CNN就是一个位置预测和类别预测完全分开的 two-stage 结构。尽管R-CNN有着相当高的正确率，two-stage 结构都使得它们不论是在训练还是预测中，都需要更多时间和算力要求。在这样的背景下，主打速度的 one-stage 物体检测架构就成为了一个研究方向，SSD就是其中的一个代表。</p>
<a id="more"></a>

<h1 id="SSD-Model"><a href="#SSD-Model" class="headerlink" title="SSD Model"></a>SSD Model</h1><p><img src="http://post-pic.nos-eastchina1.126.net/object-detection/SSD_architecture.PNG" alt="ssd_architecture"></p>
<p>上图是SSD整个网络结构。开始的部分即是一个经典的直筒式特征提取网络（truncated VGG-16 trough pool5 layer）。在目前的实现中，有人把这个网络换成了Inception，MobileNet 甚至 ResNet。这些基本都可以从谷歌开源的物体检测 API 中找到对应的模型。不同于一般的分类问题，物体检测的一大难题就是如何对不同尺寸大小的物体进行检测。特征提取网络后面新增构成 Pyramidal feature hierarchy 的卷积层就是为了解决这个问题。它们得到不同尺寸特征图，对应输入图片中不同的感受野，这样就能代表不同输入图片中不同尺寸的物体。</p>
<p>除了尺寸问题，物体检测还需要确定图片中物体的位置。R-CNN利用 RPN 直接找出物体（虽然不同的 R-CNN 的 RPN 有着不太相同的机制），而SSD则是引入了非常类似于 <strong>anchor box</strong> 的机制，论文中称之为 <strong>default box</strong>。简单地说这些矩形区域都是以特征图上的某一个像素点作为中心，并有着不同的大小和长宽比。</p>
<p><img src="http://post-pic.nos-eastchina1.126.net/object-detection/default-box.PNG" alt="default-box"></p>
<p>每一个 default box 都是一个要做预测的 candidate，这样对于整个模型，一共有6张不同尺寸的特征图需要预测，他们的尺寸分别为：<svg xmlns:xlink="http://www.w3.org/1999/xlink" width="56.043ex" height="2.843ex" style="vertical-align: -0.838ex;" viewBox="0 -863.1 24129.5 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">[38\times38,\quad19\times19,\quad10\times10,\quad5\times5,\quad3\times3,\quad1\times1]</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-MJMAIN-5B" d="M118 -250V750H255V710H158V-210H255V-250H118Z"></path>
<path stroke-width="1" id="E1-MJMAIN-33" d="M127 463Q100 463 85 480T69 524Q69 579 117 622T233 665Q268 665 277 664Q351 652 390 611T430 522Q430 470 396 421T302 350L299 348Q299 347 308 345T337 336T375 315Q457 262 457 175Q457 96 395 37T238 -22Q158 -22 100 21T42 130Q42 158 60 175T105 193Q133 193 151 175T169 130Q169 119 166 110T159 94T148 82T136 74T126 70T118 67L114 66Q165 21 238 21Q293 21 321 74Q338 107 338 175V195Q338 290 274 322Q259 328 213 329L171 330L168 332Q166 335 166 348Q166 366 174 366Q202 366 232 371Q266 376 294 413T322 525V533Q322 590 287 612Q265 626 240 626Q208 626 181 615T143 592T132 580H135Q138 579 143 578T153 573T165 566T175 555T183 540T186 520Q186 498 172 481T127 463Z"></path>
<path stroke-width="1" id="E1-MJMAIN-38" d="M70 417T70 494T124 618T248 666Q319 666 374 624T429 515Q429 485 418 459T392 417T361 389T335 371T324 363L338 354Q352 344 366 334T382 323Q457 264 457 174Q457 95 399 37T249 -22Q159 -22 101 29T43 155Q43 263 172 335L154 348Q133 361 127 368Q70 417 70 494ZM286 386L292 390Q298 394 301 396T311 403T323 413T334 425T345 438T355 454T364 471T369 491T371 513Q371 556 342 586T275 624Q268 625 242 625Q201 625 165 599T128 534Q128 511 141 492T167 463T217 431Q224 426 228 424L286 386ZM250 21Q308 21 350 55T392 137Q392 154 387 169T375 194T353 216T330 234T301 253T274 270Q260 279 244 289T218 306L210 311Q204 311 181 294T133 239T107 157Q107 98 150 60T250 21Z"></path>
<path stroke-width="1" id="E1-MJMAIN-D7" d="M630 29Q630 9 609 9Q604 9 587 25T493 118L389 222L284 117Q178 13 175 11Q171 9 168 9Q160 9 154 15T147 29Q147 36 161 51T255 146L359 250L255 354Q174 435 161 449T147 471Q147 480 153 485T168 490Q173 490 175 489Q178 487 284 383L389 278L493 382Q570 459 587 475T609 491Q630 491 630 471Q630 464 620 453T522 355L418 250L522 145Q606 61 618 48T630 29Z"></path>
<path stroke-width="1" id="E1-MJMAIN-2C" d="M78 35T78 60T94 103T137 121Q165 121 187 96T210 8Q210 -27 201 -60T180 -117T154 -158T130 -185T117 -194Q113 -194 104 -185T95 -172Q95 -168 106 -156T131 -126T157 -76T173 -3V9L172 8Q170 7 167 6T161 3T152 1T140 0Q113 0 96 17Z"></path>
<path stroke-width="1" id="E1-MJMAIN-31" d="M213 578L200 573Q186 568 160 563T102 556H83V602H102Q149 604 189 617T245 641T273 663Q275 666 285 666Q294 666 302 660V361L303 61Q310 54 315 52T339 48T401 46H427V0H416Q395 3 257 3Q121 3 100 0H88V46H114Q136 46 152 46T177 47T193 50T201 52T207 57T213 61V578Z"></path>
<path stroke-width="1" id="E1-MJMAIN-39" d="M352 287Q304 211 232 211Q154 211 104 270T44 396Q42 412 42 436V444Q42 537 111 606Q171 666 243 666Q245 666 249 666T257 665H261Q273 665 286 663T323 651T370 619T413 560Q456 472 456 334Q456 194 396 97Q361 41 312 10T208 -22Q147 -22 108 7T68 93T121 149Q143 149 158 135T173 96Q173 78 164 65T148 49T135 44L131 43Q131 41 138 37T164 27T206 22H212Q272 22 313 86Q352 142 352 280V287ZM244 248Q292 248 321 297T351 430Q351 508 343 542Q341 552 337 562T323 588T293 615T246 625Q208 625 181 598Q160 576 154 546T147 441Q147 358 152 329T172 282Q197 248 244 248Z"></path>
<path stroke-width="1" id="E1-MJMAIN-30" d="M96 585Q152 666 249 666Q297 666 345 640T423 548Q460 465 460 320Q460 165 417 83Q397 41 362 16T301 -15T250 -22Q224 -22 198 -16T137 16T82 83Q39 165 39 320Q39 494 96 585ZM321 597Q291 629 250 629Q208 629 178 597Q153 571 145 525T137 333Q137 175 145 125T181 46Q209 16 250 16Q290 16 318 46Q347 76 354 130T362 333Q362 478 354 524T321 597Z"></path>
<path stroke-width="1" id="E1-MJMAIN-35" d="M164 157Q164 133 148 117T109 101H102Q148 22 224 22Q294 22 326 82Q345 115 345 210Q345 313 318 349Q292 382 260 382H254Q176 382 136 314Q132 307 129 306T114 304Q97 304 95 310Q93 314 93 485V614Q93 664 98 664Q100 666 102 666Q103 666 123 658T178 642T253 634Q324 634 389 662Q397 666 402 666Q410 666 410 648V635Q328 538 205 538Q174 538 149 544L139 546V374Q158 388 169 396T205 412T256 420Q337 420 393 355T449 201Q449 109 385 44T229 -22Q148 -22 99 32T50 154Q50 178 61 192T84 210T107 214Q132 214 148 197T164 157Z"></path>
<path stroke-width="1" id="E1-MJMAIN-5D" d="M22 710V750H159V-250H22V-210H119V710H22Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-MJMAIN-5B" x="0" y="0"></use>
<g transform="translate(278,0)">
 <use xlink:href="#E1-MJMAIN-33"></use>
 <use xlink:href="#E1-MJMAIN-38" x="500" y="0"></use>
</g>
 <use xlink:href="#E1-MJMAIN-D7" x="1501" y="0"></use>
<g transform="translate(2502,0)">
 <use xlink:href="#E1-MJMAIN-33"></use>
 <use xlink:href="#E1-MJMAIN-38" x="500" y="0"></use>
</g>
 <use xlink:href="#E1-MJMAIN-2C" x="3503" y="0"></use>
<g transform="translate(4948,0)">
 <use xlink:href="#E1-MJMAIN-31"></use>
 <use xlink:href="#E1-MJMAIN-39" x="500" y="0"></use>
</g>
 <use xlink:href="#E1-MJMAIN-D7" x="6171" y="0"></use>
<g transform="translate(7172,0)">
 <use xlink:href="#E1-MJMAIN-31"></use>
 <use xlink:href="#E1-MJMAIN-39" x="500" y="0"></use>
</g>
 <use xlink:href="#E1-MJMAIN-2C" x="8173" y="0"></use>
<g transform="translate(9618,0)">
 <use xlink:href="#E1-MJMAIN-31"></use>
 <use xlink:href="#E1-MJMAIN-30" x="500" y="0"></use>
</g>
 <use xlink:href="#E1-MJMAIN-D7" x="10841" y="0"></use>
<g transform="translate(11842,0)">
 <use xlink:href="#E1-MJMAIN-31"></use>
 <use xlink:href="#E1-MJMAIN-30" x="500" y="0"></use>
</g>
 <use xlink:href="#E1-MJMAIN-2C" x="12843" y="0"></use>
 <use xlink:href="#E1-MJMAIN-35" x="14288" y="0"></use>
 <use xlink:href="#E1-MJMAIN-D7" x="15011" y="0"></use>
 <use xlink:href="#E1-MJMAIN-35" x="16012" y="0"></use>
 <use xlink:href="#E1-MJMAIN-2C" x="16512" y="0"></use>
 <use xlink:href="#E1-MJMAIN-33" x="17957" y="0"></use>
 <use xlink:href="#E1-MJMAIN-D7" x="18680" y="0"></use>
 <use xlink:href="#E1-MJMAIN-33" x="19681" y="0"></use>
 <use xlink:href="#E1-MJMAIN-2C" x="20181" y="0"></use>
 <use xlink:href="#E1-MJMAIN-31" x="21627" y="0"></use>
 <use xlink:href="#E1-MJMAIN-D7" x="22349" y="0"></use>
 <use xlink:href="#E1-MJMAIN-31" x="23350" y="0"></use>
 <use xlink:href="#E1-MJMAIN-5D" x="23851" y="0"></use>
</g>
</svg> 。因此，我们就有7308个box需要进行识别和预测。</p>
<h1 id="Training"><a href="#Training" class="headerlink" title="Training"></a>Training</h1><p>网络的训练是整个架构能否得到好结果的一个关键，SSD的训练里面有很多 tricky 的东西，这些也是为了解决 one-stage 结构的一些固有问题，今天就先写到这里。明天再更新。</p>
<p>插播一条新闻，今天训练的时候发现连着几个训练季的 validation loss 都升高，而 training loss 则在仍在降低。后来看了这个 <a target="_blank" rel="noopener" href="https://github.com/keras-team/keras/issues/3755">issue</a>, 想想是真的蠢，训练的脚本还留着原来 fine-tuning 的权值加载，这一波直接过拟合了验证集误差不飞起来才算是出了邪了。</p>
<h1 id="Quantize-the-SSD-architecture"><a href="#Quantize-the-SSD-architecture" class="headerlink" title="Quantize the SSD architecture"></a>Quantize the SSD architecture</h1><p>下面是对SSD的各层输入、输出尺寸以及连接情况的一个总结，调用 <code>model.summary()</code> 接口即可实现。除了处理过程中张量的尺寸，我们还能够得到整个模型需要训练的参数个数。在这个实现中整个模型有大约25.7M的参数需要训练。</p>
<p><strong>VGG16-based SSD</strong></p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br></pre></td><td class="code"><pre><span class="line">__________________________________________________________________________________________________</span><br><span class="line">Layer (type)                    Output Shape         Param #     Connected to                     </span><br><span class="line">==================================================================================================</span><br><span class="line">input_1 (InputLayer)            (None, 300, 300, 3)  0                                            </span><br><span class="line">__________________________________________________________________________________________________</span><br><span class="line">conv1_1 (Conv2D)                (None, 300, 300, 64) 1792        input_1[0][0]                    </span><br><span class="line">__________________________________________________________________________________________________</span><br><span class="line">conv1_2 (Conv2D)                (None, 300, 300, 64) 36928       conv1_1[0][0]                    </span><br><span class="line">__________________________________________________________________________________________________</span><br><span class="line">pool1 (MaxPooling2D)            (None, 150, 150, 64) 0           conv1_2[0][0]                    </span><br><span class="line">__________________________________________________________________________________________________</span><br><span class="line">conv2_1 (Conv2D)                (None, 150, 150, 128 73856       pool1[0][0]                      </span><br><span class="line">__________________________________________________________________________________________________</span><br><span class="line">conv2_2 (Conv2D)                (None, 150, 150, 128 147584      conv2_1[0][0]                    </span><br><span class="line">__________________________________________________________________________________________________</span><br><span class="line">pool2 (MaxPooling2D)            (None, 75, 75, 128)  0           conv2_2[0][0]                    </span><br><span class="line">__________________________________________________________________________________________________</span><br><span class="line">conv3_1 (Conv2D)                (None, 75, 75, 256)  295168      pool2[0][0]                      </span><br><span class="line">__________________________________________________________________________________________________</span><br><span class="line">conv3_2 (Conv2D)                (None, 75, 75, 256)  590080      conv3_1[0][0]                    </span><br><span class="line">__________________________________________________________________________________________________</span><br><span class="line">conv3_3 (Conv2D)                (None, 75, 75, 256)  590080      conv3_2[0][0]                    </span><br><span class="line">__________________________________________________________________________________________________</span><br><span class="line">pool3 (MaxPooling2D)            (None, 38, 38, 256)  0           conv3_3[0][0]                    </span><br><span class="line">__________________________________________________________________________________________________</span><br><span class="line">conv4_1 (Conv2D)                (None, 38, 38, 512)  1180160     pool3[0][0]                      </span><br><span class="line">__________________________________________________________________________________________________</span><br><span class="line">conv4_2 (Conv2D)                (None, 38, 38, 512)  2359808     conv4_1[0][0]                    </span><br><span class="line">__________________________________________________________________________________________________</span><br><span class="line">conv4_3 (Conv2D)                (None, 38, 38, 512)  2359808     conv4_2[0][0]                    </span><br><span class="line">__________________________________________________________________________________________________</span><br><span class="line">pool4 (MaxPooling2D)            (None, 19, 19, 512)  0           conv4_3[0][0]                    </span><br><span class="line">__________________________________________________________________________________________________</span><br><span class="line">conv5_1 (Conv2D)                (None, 19, 19, 512)  2359808     pool4[0][0]                      </span><br><span class="line">__________________________________________________________________________________________________</span><br><span class="line">conv5_2 (Conv2D)                (None, 19, 19, 512)  2359808     conv5_1[0][0]                    </span><br><span class="line">__________________________________________________________________________________________________</span><br><span class="line">conv5_3 (Conv2D)                (None, 19, 19, 512)  2359808     conv5_2[0][0]                    </span><br><span class="line">__________________________________________________________________________________________________</span><br><span class="line">pool5 (MaxPooling2D)            (None, 19, 19, 512)  0           conv5_3[0][0]                    </span><br><span class="line">__________________________________________________________________________________________________</span><br><span class="line">fc6 (Conv2D)                    (None, 19, 19, 1024) 4719616     pool5[0][0]                      </span><br><span class="line">__________________________________________________________________________________________________</span><br><span class="line">fc7 (Conv2D)                    (None, 19, 19, 1024) 1049600     fc6[0][0]                        </span><br><span class="line">__________________________________________________________________________________________________</span><br><span class="line">conv6_1 (Conv2D)                (None, 19, 19, 256)  262400      fc7[0][0]                        </span><br><span class="line">__________________________________________________________________________________________________</span><br><span class="line">conv6_2 (Conv2D)                (None, 10, 10, 512)  1180160     conv6_1[0][0]                    </span><br><span class="line">__________________________________________________________________________________________________</span><br><span class="line">conv7_1 (Conv2D)                (None, 10, 10, 128)  65664       conv6_2[0][0]                    </span><br><span class="line">__________________________________________________________________________________________________</span><br><span class="line">zero_padding2d_1 (ZeroPadding2D (None, 12, 12, 128)  0           conv7_1[0][0]                    </span><br><span class="line">__________________________________________________________________________________________________</span><br><span class="line">conv7_2 (Conv2D)                (None, 5, 5, 256)    295168      zero_padding2d_1[0][0]           </span><br><span class="line">__________________________________________________________________________________________________</span><br><span class="line">conv8_1 (Conv2D)                (None, 5, 5, 128)    32896       conv7_2[0][0]                    </span><br><span class="line">__________________________________________________________________________________________________</span><br><span class="line">conv4_3_norm (Normalize)        (None, 38, 38, 512)  512         conv4_3[0][0]                    </span><br><span class="line">__________________________________________________________________________________________________</span><br><span class="line">conv8_2 (Conv2D)                (None, 3, 3, 256)    295168      conv8_1[0][0]                    </span><br><span class="line">__________________________________________________________________________________________________</span><br><span class="line">pool6 (GlobalAveragePooling2D)  (None, 256)          0           conv8_2[0][0]                    </span><br><span class="line">__________________________________________________________________________________________________</span><br><span class="line">conv4_3_norm_mbox_conf (Conv2D) (None, 38, 38, 63)   290367      conv4_3_norm[0][0]               </span><br><span class="line">__________________________________________________________________________________________________</span><br><span class="line">fc7_mbox_conf (Conv2D)          (None, 19, 19, 126)  1161342     fc7[0][0]                        </span><br><span class="line">__________________________________________________________________________________________________</span><br><span class="line">conv6_2_mbox_conf (Conv2D)      (None, 10, 10, 126)  580734      conv6_2[0][0]                    </span><br><span class="line">__________________________________________________________________________________________________</span><br><span class="line">conv7_2_mbox_conf (Conv2D)      (None, 5, 5, 126)    290430      conv7_2[0][0]                    </span><br><span class="line">__________________________________________________________________________________________________</span><br><span class="line">conv8_2_mbox_conf (Conv2D)      (None, 3, 3, 126)    290430      conv8_2[0][0]                    </span><br><span class="line">__________________________________________________________________________________________________</span><br><span class="line">conv4_3_norm_mbox_loc (Conv2D)  (None, 38, 38, 12)   55308       conv4_3_norm[0][0]               </span><br><span class="line">__________________________________________________________________________________________________</span><br><span class="line">fc7_mbox_loc (Conv2D)           (None, 19, 19, 24)   221208      fc7[0][0]                        </span><br><span class="line">__________________________________________________________________________________________________</span><br><span class="line">conv6_2_mbox_loc (Conv2D)       (None, 10, 10, 24)   110616      conv6_2[0][0]                    </span><br><span class="line">__________________________________________________________________________________________________</span><br><span class="line">conv7_2_mbox_loc (Conv2D)       (None, 5, 5, 24)     55320       conv7_2[0][0]                    </span><br><span class="line">__________________________________________________________________________________________________</span><br><span class="line">conv8_2_mbox_loc (Conv2D)       (None, 3, 3, 24)     55320       conv8_2[0][0]                    </span><br><span class="line">__________________________________________________________________________________________________</span><br><span class="line">conv4_3_norm_mbox_conf_flat (Fl (None, 90972)        0           conv4_3_norm_mbox_conf[0][0]     </span><br><span class="line">__________________________________________________________________________________________________</span><br><span class="line">fc7_mbox_conf_flat (Flatten)    (None, 45486)        0           fc7_mbox_conf[0][0]              </span><br><span class="line">__________________________________________________________________________________________________</span><br><span class="line">conv6_2_mbox_conf_flat (Flatten (None, 12600)        0           conv6_2_mbox_conf[0][0]          </span><br><span class="line">__________________________________________________________________________________________________</span><br><span class="line">conv7_2_mbox_conf_flat (Flatten (None, 3150)         0           conv7_2_mbox_conf[0][0]          </span><br><span class="line">__________________________________________________________________________________________________</span><br><span class="line">conv8_2_mbox_conf_flat (Flatten (None, 1134)         0           conv8_2_mbox_conf[0][0]          </span><br><span class="line">__________________________________________________________________________________________________</span><br><span class="line">pool6_mbox_conf_flat (Dense)    (None, 126)          32382       pool6[0][0]                      </span><br><span class="line">__________________________________________________________________________________________________</span><br><span class="line">conv4_3_norm_mbox_loc_flat (Fla (None, 17328)        0           conv4_3_norm_mbox_loc[0][0]      </span><br><span class="line">__________________________________________________________________________________________________</span><br><span class="line">fc7_mbox_loc_flat (Flatten)     (None, 8664)         0           fc7_mbox_loc[0][0]               </span><br><span class="line">__________________________________________________________________________________________________</span><br><span class="line">conv6_2_mbox_loc_flat (Flatten) (None, 2400)         0           conv6_2_mbox_loc[0][0]           </span><br><span class="line">__________________________________________________________________________________________________</span><br><span class="line">conv7_2_mbox_loc_flat (Flatten) (None, 600)          0           conv7_2_mbox_loc[0][0]           </span><br><span class="line">__________________________________________________________________________________________________</span><br><span class="line">conv8_2_mbox_loc_flat (Flatten) (None, 216)          0           conv8_2_mbox_loc[0][0]           </span><br><span class="line">__________________________________________________________________________________________________</span><br><span class="line">pool6_mbox_loc_flat (Dense)     (None, 24)           6168        pool6[0][0]                      </span><br><span class="line">__________________________________________________________________________________________________</span><br><span class="line">mbox_conf (Merge)               (None, 153468)       0           conv4_3_norm_mbox_conf_flat[0][0]</span><br><span class="line">                                                                 fc7_mbox_conf_flat[0][0]         </span><br><span class="line">                                                                 conv6_2_mbox_conf_flat[0][0]     </span><br><span class="line">                                                                 conv7_2_mbox_conf_flat[0][0]     </span><br><span class="line">                                                                 conv8_2_mbox_conf_flat[0][0]     </span><br><span class="line">                                                                 pool6_mbox_conf_flat[0][0]       </span><br><span class="line">__________________________________________________________________________________________________</span><br><span class="line">pool6_reshaped (Reshape)        (None, 1, 1, 256)    0           pool6[0][0]                      </span><br><span class="line">__________________________________________________________________________________________________</span><br><span class="line">mbox_loc (Merge)                (None, 29232)        0           conv4_3_norm_mbox_loc_flat[0][0] </span><br><span class="line">                                                                 fc7_mbox_loc_flat[0][0]          </span><br><span class="line">                                                                 conv6_2_mbox_loc_flat[0][0]      </span><br><span class="line">                                                                 conv7_2_mbox_loc_flat[0][0]      </span><br><span class="line">                                                                 conv8_2_mbox_loc_flat[0][0]      </span><br><span class="line">                                                                 pool6_mbox_loc_flat[0][0]        </span><br><span class="line">__________________________________________________________________________________________________</span><br><span class="line">mbox_conf_logits (Reshape)      (None, 7308, 21)     0           mbox_conf[0][0]                  </span><br><span class="line">__________________________________________________________________________________________________</span><br><span class="line">conv4_3_norm_mbox_priorbox (Pri (None, 4332, 8)      0           conv4_3_norm[0][0]               </span><br><span class="line">__________________________________________________________________________________________________</span><br><span class="line">fc7_mbox_priorbox (PriorBox)    (None, 2166, 8)      0           fc7[0][0]                        </span><br><span class="line">__________________________________________________________________________________________________</span><br><span class="line">conv6_2_mbox_priorbox (PriorBox (None, 600, 8)       0           conv6_2[0][0]                    </span><br><span class="line">__________________________________________________________________________________________________</span><br><span class="line">conv7_2_mbox_priorbox (PriorBox (None, 150, 8)       0           conv7_2[0][0]                    </span><br><span class="line">__________________________________________________________________________________________________</span><br><span class="line">conv8_2_mbox_priorbox (PriorBox (None, 54, 8)        0           conv8_2[0][0]                    </span><br><span class="line">__________________________________________________________________________________________________</span><br><span class="line">pool6_mbox_priorbox (PriorBox)  (None, 6, 8)         0           pool6_reshaped[0][0]             </span><br><span class="line">__________________________________________________________________________________________________</span><br><span class="line">mbox_loc_final (Reshape)        (None, 7308, 4)      0           mbox_loc[0][0]                   </span><br><span class="line">__________________________________________________________________________________________________</span><br><span class="line">mbox_conf_final (Activation)    (None, 7308, 21)     0           mbox_conf_logits[0][0]           </span><br><span class="line">__________________________________________________________________________________________________</span><br><span class="line">mbox_priorbox (Merge)           (None, 7308, 8)      0           conv4_3_norm_mbox_priorbox[0][0] </span><br><span class="line">                                                                 fc7_mbox_priorbox[0][0]          </span><br><span class="line">                                                                 conv6_2_mbox_priorbox[0][0]      </span><br><span class="line">                                                                 conv7_2_mbox_priorbox[0][0]      </span><br><span class="line">                                                                 conv8_2_mbox_priorbox[0][0]      </span><br><span class="line">                                                                 pool6_mbox_priorbox[0][0]        </span><br><span class="line">__________________________________________________________________________________________________</span><br><span class="line">predictions (Merge)             (None, 7308, 33)     0           mbox_loc_final[0][0]             </span><br><span class="line">                                                                 mbox_conf_final[0][0]            </span><br><span class="line">                                                                 mbox_priorbox[0][0]              </span><br><span class="line">==================================================================================================</span><br><span class="line">Total params: 25,765,497</span><br><span class="line">Trainable params: 25,765,497</span><br><span class="line">Non-trainable params: 0</span><br></pre></td></tr></table></figure>



<p>当特征提取器的网络换成更为轻量级的 MobileNet.v1，我们可以看到参数的量非常显著地减少了。这对于计算资源有限的移动设备或者嵌入式设备非常友好。也是做 FYP 的一个方向之一。</p>
<p><strong>MobileNet.v1-based SSD</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br></pre></td><td class="code"><pre><span class="line">__________________________________________________________________________________________________</span><br><span class="line">Layer (<span class="built_in">type</span>)                    Output Shape         Param <span class="comment">#     Connected to                     </span></span><br><span class="line">==================================================================================================</span><br><span class="line">input_1 (InputLayer)            (None, 300, 300, 3)  0                                            </span><br><span class="line">__________________________________________________________________________________________________</span><br><span class="line">conv0 (Conv2D)                  (None, 150, 150, 32) 896         input_1[0][0]                    </span><br><span class="line">__________________________________________________________________________________________________</span><br><span class="line">bn0 (BatchNormalization)        (None, 150, 150, 32) 128         conv0[0][0]                      </span><br><span class="line">__________________________________________________________________________________________________</span><br><span class="line">activation_1 (Activation)       (None, 150, 150, 32) 0           bn0[0][0]                        </span><br><span class="line">__________________________________________________________________________________________________</span><br><span class="line">conv1dw (SeparableConv2D)       (None, 150, 150, 32) 1344        activation_1[0][0]               </span><br><span class="line">__________________________________________________________________________________________________</span><br><span class="line">bn1dw (BatchNormalization)      (None, 150, 150, 32) 128         conv1dw[0][0]                    </span><br><span class="line">__________________________________________________________________________________________________</span><br><span class="line">activation_2 (Activation)       (None, 150, 150, 32) 0           bn1dw[0][0]                      </span><br><span class="line">__________________________________________________________________________________________________</span><br><span class="line">conv1 (Conv2D)                  (None, 150, 150, 64) 2112        activation_2[0][0]               </span><br><span class="line">__________________________________________________________________________________________________</span><br><span class="line">bn1 (BatchNormalization)        (None, 150, 150, 64) 256         conv1[0][0]                      </span><br><span class="line">__________________________________________________________________________________________________</span><br><span class="line">activation_3 (Activation)       (None, 150, 150, 64) 0           bn1[0][0]                        </span><br><span class="line">__________________________________________________________________________________________________</span><br><span class="line">conv2dw (SeparableConv2D)       (None, 75, 75, 64)   4736        activation_3[0][0]               </span><br><span class="line">__________________________________________________________________________________________________</span><br><span class="line">bn2dw (BatchNormalization)      (None, 75, 75, 64)   256         conv2dw[0][0]                    </span><br><span class="line">__________________________________________________________________________________________________</span><br><span class="line">activation_4 (Activation)       (None, 75, 75, 64)   0           bn2dw[0][0]                      </span><br><span class="line">__________________________________________________________________________________________________</span><br><span class="line">conv2 (Conv2D)                  (None, 75, 75, 128)  8320        activation_4[0][0]               </span><br><span class="line">__________________________________________________________________________________________________</span><br><span class="line">bn2 (BatchNormalization)        (None, 75, 75, 128)  512         conv2[0][0]                      </span><br><span class="line">__________________________________________________________________________________________________</span><br><span class="line">activation_5 (Activation)       (None, 75, 75, 128)  0           bn2[0][0]                        </span><br><span class="line">__________________________________________________________________________________________________</span><br><span class="line">conv3dw (SeparableConv2D)       (None, 75, 75, 128)  17664       activation_5[0][0]               </span><br><span class="line">__________________________________________________________________________________________________</span><br><span class="line">bn3dw (BatchNormalization)      (None, 75, 75, 128)  512         conv3dw[0][0]                    </span><br><span class="line">__________________________________________________________________________________________________</span><br><span class="line">activation_6 (Activation)       (None, 75, 75, 128)  0           bn3dw[0][0]                      </span><br><span class="line">__________________________________________________________________________________________________</span><br><span class="line">conv3 (Conv2D)                  (None, 75, 75, 128)  16512       activation_6[0][0]               </span><br><span class="line">__________________________________________________________________________________________________</span><br><span class="line">bn3 (BatchNormalization)        (None, 75, 75, 128)  512         conv3[0][0]                      </span><br><span class="line">__________________________________________________________________________________________________</span><br><span class="line">activation_7 (Activation)       (None, 75, 75, 128)  0           bn3[0][0]                        </span><br><span class="line">__________________________________________________________________________________________________</span><br><span class="line">conv4dw (SeparableConv2D)       (None, 38, 38, 128)  17664       activation_7[0][0]               </span><br><span class="line">__________________________________________________________________________________________________</span><br><span class="line">bn4dw (BatchNormalization)      (None, 38, 38, 128)  512         conv4dw[0][0]                    </span><br><span class="line">__________________________________________________________________________________________________</span><br><span class="line">activation_8 (Activation)       (None, 38, 38, 128)  0           bn4dw[0][0]                      </span><br><span class="line">__________________________________________________________________________________________________</span><br><span class="line">conv4 (Conv2D)                  (None, 38, 38, 256)  33024       activation_8[0][0]               </span><br><span class="line">__________________________________________________________________________________________________</span><br><span class="line">bn4 (BatchNormalization)        (None, 38, 38, 256)  1024        conv4[0][0]                      </span><br><span class="line">__________________________________________________________________________________________________</span><br><span class="line">activation_9 (Activation)       (None, 38, 38, 256)  0           bn4[0][0]                        </span><br><span class="line">__________________________________________________________________________________________________</span><br><span class="line">conv5dw (SeparableConv2D)       (None, 38, 38, 256)  68096       activation_9[0][0]               </span><br><span class="line">__________________________________________________________________________________________________</span><br><span class="line">bn5dw (BatchNormalization)      (None, 38, 38, 256)  1024        conv5dw[0][0]                    </span><br><span class="line">__________________________________________________________________________________________________</span><br><span class="line">activation_10 (Activation)      (None, 38, 38, 256)  0           bn5dw[0][0]                      </span><br><span class="line">__________________________________________________________________________________________________</span><br><span class="line">conv5 (Conv2D)                  (None, 38, 38, 256)  65792       activation_10[0][0]              </span><br><span class="line">__________________________________________________________________________________________________</span><br><span class="line">bn5 (BatchNormalization)        (None, 38, 38, 256)  1024        conv5[0][0]                      </span><br><span class="line">__________________________________________________________________________________________________</span><br><span class="line">activation_11 (Activation)      (None, 38, 38, 256)  0           bn5[0][0]                        </span><br><span class="line">__________________________________________________________________________________________________</span><br><span class="line">conv6dw (SeparableConv2D)       (None, 19, 19, 256)  68096       activation_11[0][0]              </span><br><span class="line">__________________________________________________________________________________________________</span><br><span class="line">bn6dw (BatchNormalization)      (None, 19, 19, 256)  1024        conv6dw[0][0]                    </span><br><span class="line">__________________________________________________________________________________________________</span><br><span class="line">activation_12 (Activation)      (None, 19, 19, 256)  0           bn6dw[0][0]                      </span><br><span class="line">__________________________________________________________________________________________________</span><br><span class="line">conv6 (Conv2D)                  (None, 19, 19, 512)  131584      activation_12[0][0]              </span><br><span class="line">__________________________________________________________________________________________________</span><br><span class="line">bn6 (BatchNormalization)        (None, 19, 19, 512)  2048        conv6[0][0]                      </span><br><span class="line">__________________________________________________________________________________________________</span><br><span class="line">activation_13 (Activation)      (None, 19, 19, 512)  0           bn6[0][0]                        </span><br><span class="line">__________________________________________________________________________________________________</span><br><span class="line">conv7dw (SeparableConv2D)       (None, 19, 19, 512)  267264      activation_13[0][0]              </span><br><span class="line">__________________________________________________________________________________________________</span><br><span class="line">bn7dw (BatchNormalization)      (None, 19, 19, 512)  2048        conv7dw[0][0]                    </span><br><span class="line">__________________________________________________________________________________________________</span><br><span class="line">activation_14 (Activation)      (None, 19, 19, 512)  0           bn7dw[0][0]                      </span><br><span class="line">__________________________________________________________________________________________________</span><br><span class="line">conv7 (Conv2D)                  (None, 19, 19, 512)  262656      activation_14[0][0]              </span><br><span class="line">__________________________________________________________________________________________________</span><br><span class="line">bn7 (BatchNormalization)        (None, 19, 19, 512)  2048        conv7[0][0]                      </span><br><span class="line">__________________________________________________________________________________________________</span><br><span class="line">activation_15 (Activation)      (None, 19, 19, 512)  0           bn7[0][0]                        </span><br><span class="line">__________________________________________________________________________________________________</span><br><span class="line">conv8dw (SeparableConv2D)       (None, 19, 19, 512)  267264      activation_15[0][0]              </span><br><span class="line">__________________________________________________________________________________________________</span><br><span class="line">bn8dw (BatchNormalization)      (None, 19, 19, 512)  2048        conv8dw[0][0]                    </span><br><span class="line">__________________________________________________________________________________________________</span><br><span class="line">activation_16 (Activation)      (None, 19, 19, 512)  0           bn8dw[0][0]                      </span><br><span class="line">__________________________________________________________________________________________________</span><br><span class="line">conv8 (Conv2D)                  (None, 19, 19, 512)  262656      activation_16[0][0]              </span><br><span class="line">__________________________________________________________________________________________________</span><br><span class="line">bn8 (BatchNormalization)        (None, 19, 19, 512)  2048        conv8[0][0]                      </span><br><span class="line">__________________________________________________________________________________________________</span><br><span class="line">activation_17 (Activation)      (None, 19, 19, 512)  0           bn8[0][0]                        </span><br><span class="line">__________________________________________________________________________________________________</span><br><span class="line">conv9dw (SeparableConv2D)       (None, 19, 19, 512)  267264      activation_17[0][0]              </span><br><span class="line">__________________________________________________________________________________________________</span><br><span class="line">bn9dw (BatchNormalization)      (None, 19, 19, 512)  2048        conv9dw[0][0]                    </span><br><span class="line">__________________________________________________________________________________________________</span><br><span class="line">activation_18 (Activation)      (None, 19, 19, 512)  0           bn9dw[0][0]                      </span><br><span class="line">__________________________________________________________________________________________________</span><br><span class="line">conv9 (Conv2D)                  (None, 19, 19, 512)  262656      activation_18[0][0]              </span><br><span class="line">__________________________________________________________________________________________________</span><br><span class="line">bn9 (BatchNormalization)        (None, 19, 19, 512)  2048        conv9[0][0]                      </span><br><span class="line">__________________________________________________________________________________________________</span><br><span class="line">activation_19 (Activation)      (None, 19, 19, 512)  0           bn9[0][0]                        </span><br><span class="line">__________________________________________________________________________________________________</span><br><span class="line">conv10dw (SeparableConv2D)      (None, 19, 19, 512)  267264      activation_19[0][0]              </span><br><span class="line">__________________________________________________________________________________________________</span><br><span class="line">bn10dw (BatchNormalization)     (None, 19, 19, 512)  2048        conv10dw[0][0]                   </span><br><span class="line">__________________________________________________________________________________________________</span><br><span class="line">activation_20 (Activation)      (None, 19, 19, 512)  0           bn10dw[0][0]                     </span><br><span class="line">__________________________________________________________________________________________________</span><br><span class="line">conv10 (Conv2D)                 (None, 19, 19, 512)  262656      activation_20[0][0]              </span><br><span class="line">__________________________________________________________________________________________________</span><br><span class="line">bn10 (BatchNormalization)       (None, 19, 19, 512)  2048        conv10[0][0]                     </span><br><span class="line">__________________________________________________________________________________________________</span><br><span class="line">activation_21 (Activation)      (None, 19, 19, 512)  0           bn10[0][0]                       </span><br><span class="line">__________________________________________________________________________________________________</span><br><span class="line">conv11dw (SeparableConv2D)      (None, 19, 19, 512)  267264      activation_21[0][0]              </span><br><span class="line">__________________________________________________________________________________________________</span><br><span class="line">b11dw (BatchNormalization)      (None, 19, 19, 512)  2048        conv11dw[0][0]                   </span><br><span class="line">__________________________________________________________________________________________________</span><br><span class="line">activation_22 (Activation)      (None, 19, 19, 512)  0           b11dw[0][0]                      </span><br><span class="line">__________________________________________________________________________________________________</span><br><span class="line">conv11 (Conv2D)                 (None, 19, 19, 512)  262656      activation_22[0][0]              </span><br><span class="line">__________________________________________________________________________________________________</span><br><span class="line">bn11 (BatchNormalization)       (None, 19, 19, 512)  2048        conv11[0][0]                     </span><br><span class="line">__________________________________________________________________________________________________</span><br><span class="line">activation_23 (Activation)      (None, 19, 19, 512)  0           bn11[0][0]                       </span><br><span class="line">__________________________________________________________________________________________________</span><br><span class="line">conv12dw (SeparableConv2D)      (None, 10, 10, 512)  267264      activation_23[0][0]              </span><br><span class="line">__________________________________________________________________________________________________</span><br><span class="line">bn12dw (BatchNormalization)     (None, 10, 10, 512)  2048        conv12dw[0][0]                   </span><br><span class="line">__________________________________________________________________________________________________</span><br><span class="line">activation_24 (Activation)      (None, 10, 10, 512)  0           bn12dw[0][0]                     </span><br><span class="line">__________________________________________________________________________________________________</span><br><span class="line">conv12 (Conv2D)                 (None, 10, 10, 1024) 525312      activation_24[0][0]              </span><br><span class="line">__________________________________________________________________________________________________</span><br><span class="line">bn12 (BatchNormalization)       (None, 10, 10, 1024) 4096        conv12[0][0]                     </span><br><span class="line">__________________________________________________________________________________________________</span><br><span class="line">activation_25 (Activation)      (None, 10, 10, 1024) 0           bn12[0][0]                       </span><br><span class="line">__________________________________________________________________________________________________</span><br><span class="line">conv13dw (SeparableConv2D)      (None, 10, 10, 1024) 1058816     activation_25[0][0]              </span><br><span class="line">__________________________________________________________________________________________________</span><br><span class="line">bn13dw (BatchNormalization)     (None, 10, 10, 1024) 4096        conv13dw[0][0]                   </span><br><span class="line">__________________________________________________________________________________________________</span><br><span class="line">activation_26 (Activation)      (None, 10, 10, 1024) 0           bn13dw[0][0]                     </span><br><span class="line">__________________________________________________________________________________________________</span><br><span class="line">conv13 (Conv2D)                 (None, 10, 10, 1024) 1049600     activation_26[0][0]              </span><br><span class="line">__________________________________________________________________________________________________</span><br><span class="line">bn13 (BatchNormalization)       (None, 10, 10, 1024) 4096        conv13[0][0]                     </span><br><span class="line">__________________________________________________________________________________________________</span><br><span class="line">activation_27 (Activation)      (None, 10, 10, 1024) 0           bn13[0][0]                       </span><br><span class="line">__________________________________________________________________________________________________</span><br><span class="line">conv14_1 (Conv2D)               (None, 10, 10, 256)  262400      activation_27[0][0]              </span><br><span class="line">__________________________________________________________________________________________________</span><br><span class="line">bn14_1 (BatchNormalization)     (None, 10, 10, 256)  1024        conv14_1[0][0]                   </span><br><span class="line">__________________________________________________________________________________________________</span><br><span class="line">activation_28 (Activation)      (None, 10, 10, 256)  0           bn14_1[0][0]                     </span><br><span class="line">__________________________________________________________________________________________________</span><br><span class="line">conv14_2 (Conv2D)               (None, 5, 5, 512)    1180160     activation_28[0][0]              </span><br><span class="line">__________________________________________________________________________________________________</span><br><span class="line">bn14_2 (BatchNormalization)     (None, 5, 5, 512)    2048        conv14_2[0][0]                   </span><br><span class="line">__________________________________________________________________________________________________</span><br><span class="line">activation_29 (Activation)      (None, 5, 5, 512)    0           bn14_2[0][0]                     </span><br><span class="line">__________________________________________________________________________________________________</span><br><span class="line">conv15_1 (Conv2D)               (None, 5, 5, 128)    65664       activation_29[0][0]              </span><br><span class="line">__________________________________________________________________________________________________</span><br><span class="line">bn15_1 (BatchNormalization)     (None, 5, 5, 128)    512         conv15_1[0][0]                   </span><br><span class="line">__________________________________________________________________________________________________</span><br><span class="line">activation_30 (Activation)      (None, 5, 5, 128)    0           bn15_1[0][0]                     </span><br><span class="line">__________________________________________________________________________________________________</span><br><span class="line">conv15_2 (Conv2D)               (None, 3, 3, 256)    295168      activation_30[0][0]              </span><br><span class="line">__________________________________________________________________________________________________</span><br><span class="line">bn15_2 (BatchNormalization)     (None, 3, 3, 256)    1024        conv15_2[0][0]                   </span><br><span class="line">__________________________________________________________________________________________________</span><br><span class="line">activation_31 (Activation)      (None, 3, 3, 256)    0           bn15_2[0][0]                     </span><br><span class="line">__________________________________________________________________________________________________</span><br><span class="line">conv16_1 (Conv2D)               (None, 3, 3, 128)    32896       activation_31[0][0]              </span><br><span class="line">__________________________________________________________________________________________________</span><br><span class="line">bn16_1 (BatchNormalization)     (None, 3, 3, 128)    512         conv16_1[0][0]                   </span><br><span class="line">__________________________________________________________________________________________________</span><br><span class="line">activation_32 (Activation)      (None, 3, 3, 128)    0           bn16_1[0][0]                     </span><br><span class="line">__________________________________________________________________________________________________</span><br><span class="line">conv16_2 (Conv2D)               (None, 2, 2, 256)    295168      activation_32[0][0]              </span><br><span class="line">__________________________________________________________________________________________________</span><br><span class="line">bn16_2 (BatchNormalization)     (None, 2, 2, 256)    1024        conv16_2[0][0]                   </span><br><span class="line">__________________________________________________________________________________________________</span><br><span class="line">activation_33 (Activation)      (None, 2, 2, 256)    0           bn16_2[0][0]                     </span><br><span class="line">__________________________________________________________________________________________________</span><br><span class="line">conv17_1 (Conv2D)               (None, 2, 2, 64)     16448       activation_33[0][0]              </span><br><span class="line">__________________________________________________________________________________________________</span><br><span class="line">bn17_1 (BatchNormalization)     (None, 2, 2, 64)     256         conv17_1[0][0]                   </span><br><span class="line">__________________________________________________________________________________________________</span><br><span class="line">activation_34 (Activation)      (None, 2, 2, 64)     0           bn17_1[0][0]                     </span><br><span class="line">__________________________________________________________________________________________________</span><br><span class="line">conv17_2 (Conv2D)               (None, 1, 1, 128)    73856       activation_34[0][0]              </span><br><span class="line">__________________________________________________________________________________________________</span><br><span class="line">bn17_2 (BatchNormalization)     (None, 1, 1, 128)    512         conv17_2[0][0]                   </span><br><span class="line">__________________________________________________________________________________________________</span><br><span class="line">activation_35 (Activation)      (None, 1, 1, 128)    0           bn17_2[0][0]                     </span><br><span class="line">__________________________________________________________________________________________________</span><br><span class="line">conv11_mbox_conf (Conv2D)       (None, 19, 19, 63)   32319       activation_23[0][0]              </span><br><span class="line">__________________________________________________________________________________________________</span><br><span class="line">conv13_mbox_conf (Conv2D)       (None, 10, 10, 126)  129150      activation_27[0][0]              </span><br><span class="line">__________________________________________________________________________________________________</span><br><span class="line">conv14_2_mbox_conf (Conv2D)     (None, 5, 5, 126)    64638       activation_29[0][0]              </span><br><span class="line">__________________________________________________________________________________________________</span><br><span class="line">conv15_2_mbox_conf (Conv2D)     (None, 3, 3, 126)    32382       activation_31[0][0]              </span><br><span class="line">__________________________________________________________________________________________________</span><br><span class="line">conv16_2_mbox_conf (Conv2D)     (None, 2, 2, 126)    32382       activation_33[0][0]              </span><br><span class="line">__________________________________________________________________________________________________</span><br><span class="line">conv17_2_mbox_conf (Conv2D)     (None, 1, 1, 126)    16254       activation_35[0][0]              </span><br><span class="line">__________________________________________________________________________________________________</span><br><span class="line">conv11_mbox_loc (Conv2D)        (None, 19, 19, 12)   6156        activation_23[0][0]              </span><br><span class="line">__________________________________________________________________________________________________</span><br><span class="line">conv13_mbox_loc (Conv2D)        (None, 10, 10, 24)   24600       activation_27[0][0]              </span><br><span class="line">__________________________________________________________________________________________________</span><br><span class="line">conv14_2_mbox_loc (Conv2D)      (None, 5, 5, 24)     12312       activation_29[0][0]              </span><br><span class="line">__________________________________________________________________________________________________</span><br><span class="line">conv15_2_mbox_loc (Conv2D)      (None, 3, 3, 24)     6168        activation_31[0][0]              </span><br><span class="line">__________________________________________________________________________________________________</span><br><span class="line">conv16_2_mbox_loc (Conv2D)      (None, 2, 2, 24)     6168        activation_33[0][0]              </span><br><span class="line">__________________________________________________________________________________________________</span><br><span class="line">conv17_2_mbox_loc (Conv2D)      (None, 1, 1, 24)     3096        activation_35[0][0]              </span><br><span class="line">__________________________________________________________________________________________________</span><br><span class="line">conv11_mbox_conf_flat (Flatten) (None, 22743)        0           conv11_mbox_conf[0][0]           </span><br><span class="line">__________________________________________________________________________________________________</span><br><span class="line">conv13_mbox_conf_flat (Flatten) (None, 12600)        0           conv13_mbox_conf[0][0]           </span><br><span class="line">__________________________________________________________________________________________________</span><br><span class="line">conv14_2_mbox_conf_flat (Flatte (None, 3150)         0           conv14_2_mbox_conf[0][0]         </span><br><span class="line">__________________________________________________________________________________________________</span><br><span class="line">conv15_2_mbox_conf_flat (Flatte (None, 1134)         0           conv15_2_mbox_conf[0][0]         </span><br><span class="line">__________________________________________________________________________________________________</span><br><span class="line">conv16_2_mbox_conf_flat (Flatte (None, 504)          0           conv16_2_mbox_conf[0][0]         </span><br><span class="line">__________________________________________________________________________________________________</span><br><span class="line">conv17_2_mbox_conf_flat (Flatte (None, 126)          0           conv17_2_mbox_conf[0][0]         </span><br><span class="line">__________________________________________________________________________________________________</span><br><span class="line">conv11_mbox_loc_flat (Flatten)  (None, 4332)         0           conv11_mbox_loc[0][0]            </span><br><span class="line">__________________________________________________________________________________________________</span><br><span class="line">conv13_mbox_loc_flat (Flatten)  (None, 2400)         0           conv13_mbox_loc[0][0]            </span><br><span class="line">__________________________________________________________________________________________________</span><br><span class="line">conv14_2_mbox_loc_flat (Flatten (None, 600)          0           conv14_2_mbox_loc[0][0]          </span><br><span class="line">__________________________________________________________________________________________________</span><br><span class="line">conv15_2_mbox_loc_flat (Flatten (None, 216)          0           conv15_2_mbox_loc[0][0]          </span><br><span class="line">__________________________________________________________________________________________________</span><br><span class="line">conv16_2_mbox_loc_flat (Flatten (None, 96)           0           conv16_2_mbox_loc[0][0]          </span><br><span class="line">__________________________________________________________________________________________________</span><br><span class="line">conv17_2_mbox_loc_flat (Flatten (None, 24)           0           conv17_2_mbox_loc[0][0]          </span><br><span class="line">__________________________________________________________________________________________________</span><br><span class="line">mbox_conf (Concatenate)         (None, 40257)        0           conv11_mbox_conf_flat[0][0]      </span><br><span class="line">                                                                 conv13_mbox_conf_flat[0][0]      </span><br><span class="line">                                                                 conv14_2_mbox_conf_flat[0][0]    </span><br><span class="line">                                                                 conv15_2_mbox_conf_flat[0][0]    </span><br><span class="line">                                                                 conv16_2_mbox_conf_flat[0][0]    </span><br><span class="line">                                                                 conv17_2_mbox_conf_flat[0][0]    </span><br><span class="line">__________________________________________________________________________________________________</span><br><span class="line">mbox_loc (Concatenate)          (None, 7668)         0           conv11_mbox_loc_flat[0][0]       </span><br><span class="line">                                                                 conv13_mbox_loc_flat[0][0]       </span><br><span class="line">                                                                 conv14_2_mbox_loc_flat[0][0]     </span><br><span class="line">                                                                 conv15_2_mbox_loc_flat[0][0]     </span><br><span class="line">                                                                 conv16_2_mbox_loc_flat[0][0]     </span><br><span class="line">                                                                 conv17_2_mbox_loc_flat[0][0]     </span><br><span class="line">__________________________________________________________________________________________________</span><br><span class="line">mbox_conf_logits (Reshape)      (None, 1917, 21)     0           mbox_conf[0][0]                  </span><br><span class="line">__________________________________________________________________________________________________</span><br><span class="line">conv11_mbox_priorbox (PriorBox) (None, 1083, 8)      0           activation_23[0][0]              </span><br><span class="line">__________________________________________________________________________________________________</span><br><span class="line">conv13_mbox_priorbox (PriorBox) (None, 600, 8)       0           activation_27[0][0]              </span><br><span class="line">__________________________________________________________________________________________________</span><br><span class="line">conv14_2_mbox_priorbox (PriorBo (None, 150, 8)       0           activation_29[0][0]              </span><br><span class="line">__________________________________________________________________________________________________</span><br><span class="line">conv15_2_mbox_priorbox (PriorBo (None, 54, 8)        0           activation_31[0][0]              </span><br><span class="line">__________________________________________________________________________________________________</span><br><span class="line">conv16_2_mbox_priorbox (PriorBo (None, 24, 8)        0           activation_33[0][0]              </span><br><span class="line">__________________________________________________________________________________________________</span><br><span class="line">conv17_2_mbox_priorbox (PriorBo (None, 6, 8)         0           activation_35[0][0]              </span><br><span class="line">__________________________________________________________________________________________________</span><br><span class="line">mbox_loc_final (Reshape)        (None, 1917, 4)      0           mbox_loc[0][0]                   </span><br><span class="line">__________________________________________________________________________________________________</span><br><span class="line">mbox_conf_final (Activation)    (None, 1917, 21)     0           mbox_conf_logits[0][0]           </span><br><span class="line">__________________________________________________________________________________________________</span><br><span class="line">mbox_priorbox (Concatenate)     (None, 1917, 8)      0           conv11_mbox_priorbox[0][0]       </span><br><span class="line">                                                                 conv13_mbox_priorbox[0][0]       </span><br><span class="line">                                                                 conv14_2_mbox_priorbox[0][0]     </span><br><span class="line">                                                                 conv15_2_mbox_priorbox[0][0]     </span><br><span class="line">                                                                 conv16_2_mbox_priorbox[0][0]     </span><br><span class="line">                                                                 conv17_2_mbox_priorbox[0][0]     </span><br><span class="line">__________________________________________________________________________________________________</span><br><span class="line">predictions (Concatenate)       (None, 1917, 33)     0           mbox_loc_final[0][0]             </span><br><span class="line">                                                                 mbox_conf_final[0][0]            </span><br><span class="line">                                                                 mbox_priorbox[0][0]              </span><br><span class="line">==================================================================================================</span><br><span class="line">Total params: 8,624,505</span><br><span class="line">Trainable params: 8,599,161</span><br><span class="line">Non-trainable params: 25,344</span><br><span class="line">__________________________________________________________________________________________________</span><br></pre></td></tr></table></figure>



<h1 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h1><ol>
<li><a target="_blank" rel="noopener" href="https://arxiv.org/abs/1512.02325v5">Single Shot MultiBox Detector</a></li>
<li><a target="_blank" rel="noopener" href="https://github.com/rykov8/ssd_keras">GitHub - rykov8/ssd_keras</a></li>
<li><a target="_blank" rel="noopener" href="https://www.zhihu.com/question/49455386">Zhihu - Why is SSD weak in small object detection?</a></li>
<li><a target="_blank" rel="noopener" href="https://www.zhihu.com/question/50910763">Zhihu - What improvements does SSD method have?</a></li>
<li><a target="_blank" rel="noopener" href="https://zhuanlan.zhihu.com/p/24954433">Zhihu-SSD</a></li>
<li><a target="_blank" rel="noopener" href="https://zhuanlan.zhihu.com/p/29410169">Zhihu-What does SSD train?</a></li>
<li><a target="_blank" rel="noopener" href="http://blog.csdn.net/u010167269/article/details/52563573">Paper-Reading: SSD</a></li>
<li><a target="_blank" rel="noopener" href="https://arxiv.org/abs/1612.03144">Feature Pyramid Networks</a></li>
<li><a target="_blank" rel="noopener" href="http://scikit-learn.org/stable/auto_examples/model_selection/plot_precision_recall.html">Precision &amp; Recall</a></li>
<li><a target="_blank" rel="noopener" href="https://stats.stackexchange.com/questions/260430/average-precision-in-object-detection">Pseudo Code for precision</a></li>
</ol>

    </div>

    
    
    

    <footer class="post-footer">
          <div class="post-tags">
              <a href="/tags/Object-Detection/" rel="tag"><i class="fa fa-tag"></i> Object-Detection</a>
              <a href="/tags/SSD/" rel="tag"><i class="fa fa-tag"></i> SSD</a>
              <a href="/tags/Computer-Vision/" rel="tag"><i class="fa fa-tag"></i> Computer-Vision</a>
          </div>

        

          <div class="post-nav">
            <div class="post-nav-item">
                <a href="/post/Algorithm%20Analysis/" rel="prev" title="数据结构算法笔记：算法分析">
                  <i class="fa fa-chevron-left"></i> 数据结构算法笔记：算法分析
                </a>
            </div>
            <div class="post-nav-item">
                <a href="/post/%E7%BB%9F%E8%AE%A1%E5%AD%A6%E4%B9%A0%E6%A6%82%E8%AE%BA/" rel="next" title="统计学习基本概念（1）">
                  统计学习基本概念（1） <i class="fa fa-chevron-right"></i>
                </a>
            </div>
          </div>
    </footer>
  </article>
</div>






      

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      const activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      const commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

    </div>
  </main>

  <footer class="footer">
    <div class="footer-inner">
      

      

<div class="copyright">
  
  &copy; 2017 – 
  <span itemprop="copyrightYear">2021</span>
  <span class="with-love">
    <i class="fa fa-bolt"></i>
  </span>
  <span class="author" itemprop="copyrightHolder"><a target="_blank" rel="noopener" href="https://magi003769.github.io/"><b>Jeff Wong</b></a></span>
</div>
  <div class="powered-by">Powered by <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.js.org/" class="theme-link" rel="noopener" target="_blank">NexT.Gemini</a>
  </div>

    </div>
  </footer>

  
  <script src="//cdn.jsdelivr.net/npm/animejs@3.2.1/lib/anime.min.js"></script>
<script src="/js/utils.js"></script><script src="/js/next-boot.js"></script>

  
















  <script>
    NProgress.configure({
      showSpinner: true
    });
    NProgress.start();
    document.addEventListener('readystatechange', () => {
      if (document.readyState === 'interactive') {
        NProgress.inc(0.8);
      }
      if (document.readyState === 'complete') {
        NProgress.done();
      }
    });
    document.addEventListener('pjax:send', () => {
      NProgress.start();
    });
    document.addEventListener('pjax:success', () => {
      NProgress.done();
    });
  </script>


  








  

  

</body>
</html>
